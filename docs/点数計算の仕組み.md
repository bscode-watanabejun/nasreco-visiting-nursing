# 訪問看護の点数計算の仕組み

このシステムでは、訪問看護の請求に必要な**訪問点数**と**特管点数**を自動計算しています。

## 📊 点数計算の全体像

```
┌─────────────────────────────────────────────┐
│           月次請求金額の計算式              │
│                                             │
│  請求金額 = (訪問点数 + 特管点数) × 10円   │
└─────────────────────────────────────────────┘
        ↓              ↓
   訪問ごとに計算    月額固定
```

---

## 1️⃣ 訪問点数（訪問ごとに計算）

### 計算タイミング
- **訪問記録を作成・保存するたびに自動計算**されます
- 計算結果は記録に保存され、後から変更可能です

### 計算内容

| 項目 | 点数 | 算定条件 |
|------|------|----------|
| **基本点数** | 500点 | 全訪問に適用 |
| **複数回訪問加算** | +100点 | 同日2回目以降の訪問 |
| **緊急訪問加算** | +200点 | 緊急訪問理由を記録した場合 |
| **長時間訪問加算** | +150点 | 訪問時間が90分以上 |
| **同一建物減算** | -50点 | 同日に同じ建物の他利用者も訪問 |

### 計算例

**例1: 通常訪問（60分）**
```
基本点数: 500点
合計: 500点
```

**例2: 同日2回目の訪問（60分）**
```
基本点数: 500点
複数回訪問加算: +100点
合計: 600点
```

**例3: 緊急訪問（120分）**
```
基本点数: 500点
緊急訪問加算: +200点
長時間訪問加算: +150点
合計: 850点
```

**例4: 同一建物での訪問（60分）**
```
基本点数: 500点
同一建物減算: -50点
合計: 450点
```

---

## 2️⃣ 特管点数（月額固定）

### 計算タイミング
- **月次実績画面で集計時に自動計算**されます
- 利用者ごとの特別管理加算を月単位で算定

### 仕組み

1. **利用者マスタで設定**
   - 患者詳細画面の「特別管理加算」タブで設定
   - 複数の特管項目を選択可能（在宅酸素療法、褥瘡ケアなど）
   - 有効期間（開始日〜終了日）を指定

2. **特管マスタから点数を取得**
   - 管理画面で登録された特管項目ごとの月額点数
   - 例：在宅酸素療法 = 5,000点/月

3. **月次集計時に自動算定**
   - 対象月に有効期間が重なる特管項目を集計
   - 複数項目がある場合は合算

### 特管マスタの例

| 区分 | 表示名 | 月額点数 | 保険種別 |
|------|--------|----------|----------|
| special_001 | 在宅酸素療法 | 5,000点 | 医療保険（高） |
| special_002 | 気管カニューレ | 5,000点 | 医療保険（高） |
| special_003 | 真皮を越える褥瘡 | 2,500点 | 医療保険（低） |
| special_004 | 点滴注射管理 | 500点 | 介護保険（高） |

### 計算例

**田中太郎さん（2025年10月の特管点数）**

設定内容：
- 在宅酸素療法（5,000点/月）: 2025/9/1 〜 継続中
- 褥瘡ケア（2,500点/月）: 2025/10/15 〜 2025/11/30

```
10月の特管点数:
  在宅酸素療法: 5,000点
  褥瘡ケア: 2,500点
  合計: 7,500点
```

---

## 3️⃣ 月次請求金額の計算

### 実際の計算例

**佐藤花子さんの2025年10月実績**

| 項目 | 内容 |
|------|------|
| 訪問回数 | 12回 |
| 訪問点数の内訳 | 基本500点×10回 + 緊急850点×2回 = 6,700点 |
| 特管点数 | 在宅酸素療法 5,000点 |
| **合計点数** | **11,700点** |
| **請求金額** | **117,000円**（11,700点 × 10円） |

---

## 💡 現在の実装状況

### ✅ 実装済み機能

1. **訪問点数の自動計算**
   - 記録作成時に加算・減算を自動判定
   - 計算結果を訪問記録に保存
   - 月次実績で集計表示

2. **特管点数の自動算定**
   - 利用者ごとの特管設定
   - 有効期間の自動判定
   - 月次実績で自動集計

3. **月次実績画面**
   - 利用者別の訪問点数・特管点数を表示
   - 加算の内訳を確認可能
   - CSV出力機能

### 📋 現在の制限事項

1. **点数は仮の値を使用**
   - 基本点数500点などは例示用の値
   - 実際の診療報酬点数表に基づく調整が必要

2. **一部の加算に未対応**
   - 深夜・早朝加算
   - 難病等複数回訪問加算の区分
   - 24時間対応体制加算
   - ターミナルケア加算
   - など

---

## 🔧 カスタマイズ可能な項目

### 1. 訪問点数の調整

**ファイル**: `server/routes.ts` の `calculateBonusesAndPoints` 関数

調整可能な項目：
- 基本点数（現在500点）
- 各加算の点数
- 加算の算定条件（時間、回数など）
- 新しい加算項目の追加

### 2. 特管マスタの設定

**画面**: 管理画面 > 特別管理加算マスタ

調整可能な項目：
- 特管項目の追加・編集
- 月額点数の変更
- 保険種別の設定
- 記録フィールドのカスタマイズ

---

## 📌 よくある質問

### Q1. 点数の手動修正は可能ですか？
A. はい、訪問記録の編集画面で「算定点数」を直接修正できます。自動計算が誤っている場合や特殊な算定が必要な場合に使用してください。

### Q2. 複数の特管を同時に算定できますか？
A. はい、利用者マスタで複数の特管項目を選択できます。それぞれの月額点数が合算されます。

### Q3. 月途中から特管を開始した場合は？
A. 現在の実装では、月のどこかで有効期間が重なっていれば満額算定されます。日割り計算が必要な場合は追加実装が必要です。

### Q4. 保険種別（医療保険・介護保険）の判定は？
A. 特管マスタで保険種別を設定できますが、現在は参考情報として記録しているのみです。実際の請求時の保険判定ロジックは別途実装が必要です。

### Q5. レセプト出力機能はありますか？
A. 現在はCSV出力機能のみです。レセコン連携や電子請求フォーマット出力は今後の実装予定です。

---

## 📅 今後の拡張予定

1. **診療報酬点数表の完全対応**
   - 正確な基本点数の設定
   - 全加算項目の実装
   - 保険種別ごとの点数管理

2. **日割り計算機能**
   - 月途中の特管開始・終了時の日割り
   - 入院・ショートステイ時の控除

3. **レセプト連携**
   - 電子請求フォーマット対応
   - レセコンへのデータ出力
   - 国保連・支払基金対応

4. **詳細な加算管理**
   - 時間帯別加算（深夜・早朝）
   - 体制加算（24時間対応など）
   - 看護・介護職員連携加算

---

**作成日**: 2025年10月13日
**対象バージョン**: v1.0
