# 訪問看護アプリ必須機能 実装ロードマップ

> **作成日**: 2025-10-04
> **最終更新**: 2025-10-15
> **目的**: 訪問看護アプリとして実運用可能な状態にするための必須機能実装計画
> **現在**: Phase 1-3完了、Phase 4-6（レセプト機能強化）計画中

---

## 📊 現状分析サマリー

### 実装状況（2025-10-15更新）
- **基本業務フロー**: ✅ 95%以上 実装完了（患者管理、スケジュール、訪問記録、検索機能）
- **法令遵守・保険請求機能（基本版）**: ✅ 100% 実装完了
- **総合評価**: ✅ **実運用可能** - Phase 1〜3の全必須機能実装完了
- **レセプト機能強化**: 🚧 Phase 4-6 計画中（診療報酬点数表完全対応、電子請求、改定対応）

### 実装済みの主要機能 ✅

#### 基本機能
1. 患者基本情報管理（氏名、連絡先、既往歴、介護度、保険種別）
2. 訪問スケジュール管理（予定登録、担当割当、ステータス管理、検索機能）
3. 訪問記録作成（バイタルサイン、観察事項、実施ケア、添付ファイル、写真撮影）
4. 訪問記録の下書き・完成・承認フロー
5. バイタルサイン推移グラフ
6. スタッフ管理・権限管理
7. マルチテナント対応（施設・企業階層）
8. 建物管理機能（同一建物減算対応）

#### Phase 1: 法令遵守・保険請求機能 ✅（2025-10-05完了）
- 訪問看護指示書管理（有効期限アラート付き）
- 保険証情報管理（医療保険・介護保険）
- 医師・ケアマネージャー情報管理
- 基本的な加算計算ロジック（複数回訪問、長時間訪問、緊急訪問、同一建物減算）

#### Phase 2: レセプト基盤構築 ✅（2025-10-05完了）
- 月次訪問実績集計機能
- レセプト基本データ出力（CSV）
- 訪問看護計画書管理・PDF出力（日本語対応）
- 訪問看護報告書管理・PDF出力（日本語対応）

#### Phase 3: 業務効率化 ✅（2025-10-05完了）
- 契約書・同意書管理（PDF保管、立会人記録）
- スケジュールと訪問記録の完全紐付け（訪問日連動、自動選択）
- 繰り返しスケジュール自動生成（週次・隔週・月次パターン）

#### 追加実装機能
- 患者名・看護師名による検索機能（訪問記録、スケジュール管理）
- 訪問日に連動したスケジュール取得
- スケジュールが1件のみの場合の自動選択
- 週表示でのスケジュールステータス表示

---

## ✅ Phase 1-3 実装完了済み（2025-10-05）

すべての必須機能が実装完了しました。以下はアーカイブとして参照用に残します。

<details>
<summary>📋 実装完了した機能一覧（クリックで展開）</summary>

### Phase 1: 法令遵守・保険請求機能 ✅
1. ✅ 訪問看護指示書管理機能
2. ✅ 保険証情報管理（医療保険・介護保険）
3. ✅ レセプト作成機能（基本版）
4. ✅ 訪問看護計画書・報告書管理機能
5. ✅ 医師・ケアマネージャー情報管理
6. ✅ 同意書・契約書管理機能

### Phase 2: レセプト基盤構築 ✅
1. ✅ 月次訪問実績集計API
2. ✅ レセプトデータCSV出力
3. ✅ 訪問看護計画書・報告書PDF出力（日本語対応）

### Phase 3: 業務効率化 ✅
1. ✅ 訪問予定と訪問実績の完全な紐付け
2. ✅ 繰り返しスケジュール自動生成（週次・隔週・月次）
3. ✅ 契約書・同意書管理の完成

### 追加実装機能 ✅
1. ✅ 加算管理の強化（複数回訪問、長時間訪問、緊急訪問、同一建物減算）
2. ✅ 建物管理機能
3. ✅ 添付ファイル・写真撮影機能
4. ✅ 検索機能（患者名・看護師名）
5. ✅ 訪問日連動スケジュール取得
6. ✅ スケジュールステータス表示

</details>

---

## 🎯 実装フェーズ計画（完了）

### **Phase 1: 法令遵守・保険請求の最低限実装** ✅ 完了（2025-10-05）
~~**期間**: 2-3週間~~
**目標**: ✅ 実運用開始可能な状態 - 達成

**実装項目**:
1. ✅ 訪問看護指示書管理
2. ✅ 保険証情報管理
3. ✅ 医師・ケアマネージャー情報管理
4. ✅ 基本的な加算計算ロジック

**データベーススキーマ変更**:
- ✅ `doctor_orders`テーブル新設（訪問看護指示書）
- ✅ `insurance_cards`テーブル新設（保険証情報）
- ✅ `medical_institutions`テーブル新設（医療機関マスタ）
- ✅ `care_managers`テーブル新設（ケアマネージャーマスタ）
- ✅ `patients`テーブル拡張（doctorId, careManagerId追加）

---

### **Phase 2: レセプト基盤構築** ✅ 完了（2025-10-05）
~~**期間**: 2-3週間~~
**目標**: ✅ 月次請求業務を半自動化 - 達成

**実装項目**:
1. ✅ 月次訪問実績集計機能
2. ✅ レセプト基本データ出力（CSV）
3. ✅ 訪問看護計画書・報告書（PDF出力付き）

**データベーススキーマ変更**:
- ✅ `care_plans`テーブル新設（訪問看護計画書）
- ✅ `care_reports`テーブル新設（訪問看護報告書）
- ✅ `nursingRecords`テーブル拡張（加算計算結果フィールド追加）

---

### **Phase 3: 業務効率化** ✅ 完了（2025-10-05）
~~**期間**: 1-2週間~~
**目標**: ✅ 日常業務のストレス軽減 - 達成

**実装項目**:
1. ✅ 契約書・同意書管理（PDF保管、立会人記録）
2. ✅ スケジュールと記録の完全紐付け（訪問日連動、自動選択）
3. ✅ 繰り返しスケジュール自動生成（週次・隔週・月次）

**データベーススキーマ変更**:
- ✅ `contracts`テーブル新設（契約書・同意書）
- ✅ `nursingRecords`テーブル拡張（scheduleId、visitDate追加）
- ✅ `buildings`テーブル新設（建物管理）

---

## 📋 データベーススキーマ変更サマリー（実装完了）

### 新規テーブル（8つ）✅
1. ✅ `doctor_orders` - 訪問看護指示書
2. ✅ `insurance_cards` - 保険証情報
3. ✅ `medical_institutions` - 医療機関マスタ
4. ✅ `care_managers` - ケアマネージャーマスタ
5. ✅ `care_plans` - 訪問看護計画書
6. ✅ `care_reports` - 訪問看護報告書
7. ✅ `contracts` - 契約書・同意書
8. ✅ `buildings` - 建物管理（同一建物減算対応）

### 既存テーブル拡張 ✅
- ✅ `patients`:
  - `doctorId` (varchar, FK to medical_institutions)
  - `careManagerId` (varchar, FK to care_managers)
  - `buildingId` (varchar, FK to buildings)
- ✅ `nursingRecords`:
  - `scheduleId` (varchar, FK to schedules)
  - `visitDate` (date, 訪問日)
  - `calculatedPoints` (integer, 算定点数)
  - `appliedBonuses` (json, 適用加算の詳細)
  - `hasAdditionalPaymentAlert` (boolean, 加算未入力アラート)

---

## ⏱️ 実装期間の見積もり（完了）

| フェーズ | 予定期間 | 実績 | ステータス |
|---------|------|------|----------|
| Phase 1 | 2-3週間 | 完了 | ✅ |
| Phase 2 | 2-3週間 | 完了 | ✅ |
| Phase 3 | 1-2週間 | 完了 | ✅ |

~~**合計**: 5-8週間で実用最小限の訪問看護アプリが完成~~
**実績**: ✅ **Phase 1-3 すべて完了（2025-10-05）**

---

## 🚀 到達状態（2025-10-05）

### ✅ すべてのフェーズ完了

#### Phase 1完了（法令遵守・保険請求基盤）
- ✅ 法令遵守: 指示書管理で適法運用可能
- ✅ 多職種連携: 医師・ケアマネ情報で情報共有可能
- ✅ 基本加算: 主要な加算の自動判定・計算
- ✅ 保険証管理: レセプト請求の基盤完成

#### Phase 2完了（レセプト基盤構築）
- ✅ 保険請求: 月次集計→CSV出力で請求業務を大幅効率化
- ✅ 計画書・報告書: 介護保険請求の要件を満たす（PDF出力対応）
- ✅ レセプト基盤: 外部レセプトソフトへの連携準備完了
- ✅ 加算計算: 複数回訪問、長時間訪問、緊急訪問、同一建物減算の自動判定

#### Phase 3完了（業務効率化）
- ✅ 業務フロー: スケジュール→訪問→記録→報告の完全サイクル
- ✅ 契約管理: コンプライアンス対応（契約書・同意書管理）
- ✅ 効率化: 繰り返しスケジュール自動生成
- ✅ 検索機能: 患者名・看護師名による高速検索
- ✅ 紐付け: スケジュールと訪問記録の完全連携

---

## 🎯 今後の拡張可能性

Phase 1-3の基盤が完成したことで、以下の付加価値機能の実装が可能になりました：

### 短期的な拡張候補
1. **データ分析・可視化**
   - 患者別の訪問頻度分析
   - 加算取得率の可視化
   - 看護師の稼働状況分析

2. **通知機能の強化**
   - 指示書期限切れの事前通知（メール・アプリ通知）
   - スケジュール変更の関係者への自動通知
   - 未完了記録のリマインダー

3. **モバイル対応**
   - 訪問先でのスマートフォン入力対応
   - オフライン対応（訪問先で記録→帰社後同期）

### 中長期的な拡張候補
1. **AI支援機能**
   - 訪問記録の音声入力・自動文字起こし
   - 加算漏れの自動検知
   - 訪問スケジュールの最適化提案

2. **外部連携**
   - 電子カルテとの連携
   - レセプトソフトとの直接連携（API）
   - ケアマネ事業所との情報共有システム

3. **セキュリティ強化**
   - 二段階認証
   - 監査ログの詳細記録
   - アクセス権限の細分化

---

## 📌 運用上の注意事項

### 実運用開始前のチェックリスト
- [ ] 実際の患者データでの動作確認
- [ ] スタッフへの操作トレーニング実施
- [ ] バックアップ体制の確立
- [ ] 障害時の対応手順の整備
- [ ] 個人情報保護方針の確認

### 継続的な改善
- ユーザーフィードバックの収集と反映
- 法令改正への対応（診療報酬改定等）
- 定期的なセキュリティアップデート

---

## 🚧 Phase 4-6: レセプト機能強化計画（2025-10-15追加）

### 📋 背景と課題

#### 東海グループ様フィードバック（2025-10-14）
Phase 1-3で基本的なレセプト機能は実装済みだが、以下の課題が明らかになりました：

- ❌ **厚生労働省の正式な点数表に未対応**（現在は簡易版：500点ベース）
- ❌ **医療保険19項目・介護保険15項目の加算が未実装**
- ❌ **レセプト電子請求フォーマット未対応**（国保連・支払基金）
- ❌ **加算漏れチェック機能がない**
- ❌ **診療報酬改定への柔軟な対応が不安**
  - 医療保険：2年に1回改定（偶数年の4月）
  - 介護保険：3年に1回改定（2024年、2027年...）
  - 改定のたびにコード修正が必要では運用困難

---

### 🎯 設計方針：改定対応のための3本柱

Phase 4-6では、**2026年4月・2027年4月の診療報酬改定にコード変更なしで対応できる設計**を採用します。

#### 1. **マスタテーブル方式**
加算項目をデータベースで管理し、管理画面から点数変更可能

```
加算マスタテーブル (bonus_master)
├─ 加算コード、加算名
├─ 点数/金額
├─ 保険種別（医療/介護）
├─ 算定ルール（JSON）
├─ 有効期間（validFrom, validTo）
└─ バージョン管理
```

#### 2. **バージョン管理**
改定時期ごとに加算マスタのバージョンを管理

```
2024年度版（valid_from: 2024-04-01, valid_to: 2026-03-31）
├─ 緊急訪問看護加算: 2650円/2000円
└─ 長時間訪問看護加算: 5200円

2026年度版（valid_from: 2026-04-01, valid_to: null）
├─ 緊急訪問看護加算: 2800円/2100円（改定）
└─ 長時間訪問看護加算: 5500円（改定）
```

**メリット**:
- 過去のレセプトデータの再計算が正確
- 改定前後の比較分析が可能
- 段階的な移行が可能

#### 3. **ルールエンジン**
算定条件を事前定義されたパターンで管理（JSON構造だがUI完全隠蔽）

```
事前定義パターン例:
- 月14日閾値型（緊急訪問等）
- 同一建物区分型（複数名訪問等）
- 時間帯別型（夜間・深夜等）
- 回数制限型（週1回、月2回等）
- 訪問時間長型（90分超等）
- 年齢区分型（6歳未満等）
```

**UI設計**:
- ✅ 点数変更はシンプルなフォーム入力
- ✅ JSONは完全に裏側に隠蔽
- ✅ 90%の改定は管理画面のみで対応可能
- ✅ 複雑な変更（新設加算等）はサポート対応

---

### **Phase 4: 診療報酬点数表完全対応 + 改定対応基盤**
**期間**: 5週間
**優先度**: ★★★ 最優先
**目標**: 正確な保険請求と改定対応の自動化

#### 実装項目

##### Week 1-2: 基盤構築
**データベース設計・実装**
- [ ] `bonus_master` テーブル新設
  - バージョン管理（version, validFrom, validTo）
  - 点数タイプ（固定 or パターン別）
  - 事前定義ルール + 高度ルール（JSON）
  - 回数制限・併算定制御
- [ ] `bonus_calculation_history` テーブル新設
  - 計算履歴・根拠の完全記録
  - 手動調整フラグ・理由記録
- [ ] `monthly_receipts` テーブル新設
  - 月次レセプトサマリ

**ルールエンジン実装**
- [ ] 10種類の事前定義パターン対応
  - 月14日閾値型、同一建物区分型、時間帯別型
  - 回数制限型、訪問時間長型、年齢区分型
  - 併算定制御型、固定点数型、条件付き固定型、複合条件型
- [ ] 条件評価エンジン（gte, lte, eq, isNotEmpty等）
- [ ] バージョン自動判定（訪問日に応じた適用）

##### Week 3: 管理画面実装
**加算マスタ管理UI**
- [ ] 加算一覧・検索・フィルタ機能
- [ ] 加算編集フォーム
  - 点数変更入力欄（パターン別）
  - 有効期間設定カレンダー
  - 回数制限ドロップダウン
  - 併算定設定チェックボックス
- [ ] バージョン管理機能
  - 「新バージョン作成」ボタン（既存版コピー）
  - バージョン切替・比較表示
- [ ] インポート/エクスポート（CSV）

##### Week 4: 医療保険加算の実装
**19項目の加算登録**（参考資料：訪看（介護保険・医療保険）.pdf）
- [ ] ①緊急訪問看護加算（月14日目まで2650円、以降2000円）
- [ ] ②難病等複数回訪問加算（1日2回/3回以上、同一建物区分）
- [ ] ③長時間訪問看護加算（90分超、週1回限定）
- [ ] ④乳幼児加算（6歳未満、基準告示第2の4対応）
- [ ] ⑤複数名訪問看護加算（イ・ロ・ハ・ニの区分、週回数制限）
- [ ] ⑥夜間・早朝/深夜訪問看護加算
- [ ] ⑦特別地域訪問看護加算
- [ ] ⑧24時間対応体制加算（看護業務負担軽減判定）
- [ ] ⑨特別管理加算（5000円/2500円の区分）
- [ ] ⑩退院時共同指導加算・特別管理指導加算
- [ ] ⑪退院時支援指導加算
- [ ] ⑫在宅連携指導加算（月1回限り）
- [ ] ⑬在宅患者緊急時等カンファレンス（月2回限り）
- [ ] ⑭精神科重症患者支援管理連携加算
- [ ] ⑮看護・介護職員連携強化加算
- [ ] ⑯専門管理加算（緩和ケア、褥瘡ケア、特定行為研修）
- [ ] ⑰訪問看護医療DX情報活用加算
- [ ] ⑱訪問看護ターミナルケア療養費（1/2の区分）
- [ ] ⑲訪問看護ベースアップ評価料（Ⅰ/Ⅱ）

**実装内容**
- [ ] 各加算の算定ルールJSON定義
- [ ] 事前定義パターン割り当て
- [ ] 初期バージョン（2024年度版）登録
- [ ] 訪問記録作成時の加算自動判定実装

##### Week 5: 介護保険加算の実装
**15項目の加算登録**
- [ ] ①夜間・早朝加算/深夜加算
- [ ] ②複数名訪問加算（Ⅰ/Ⅱ）
- [ ] ③長時間訪問看護加算
- [ ] ④専門管理加算
- [ ] ⑤遠隔死亡診断補助加算
- [ ] ⑥初回加算（Ⅰ/Ⅱ）
- [ ] ⑦退院時共同指導加算
- [ ] ⑧看護・介護職員連携強化加算
- [ ] ⑨看護体制強化加算（Ⅰ/Ⅱ、介護予防）
- [ ] ⑩口腔連携加算
- [ ] ⑪緊急時訪問看護加算（Ⅰ/Ⅱ）
- [ ] ⑫特別管理加算（Ⅰ/Ⅱ）
- [ ] ⑬サービス提供体制強化加算（Ⅰ/Ⅱ）
- [ ] ⑭ターミナルケア加算
- [ ] ⑮特別地域・中山間地域加算

**統合テスト**
- [ ] 医療保険・介護保険の加算計算テスト
- [ ] バージョン切替テスト
- [ ] 改定シミュレーションテスト（2026年度版への移行）

**Phase 4 成果物**:
- ✅ 全34加算が稼働（2024年度版）
- ✅ 管理画面で点数変更可能
- ✅ 改定対応の基盤完成
- ✅ コード変更なしで2026年4月改定に対応可能

---

### **Phase 5: レセプト電子請求対応**
**期間**: 3週間
**優先度**: ★★☆ 高
**目標**: 国保連・支払基金への電子請求を実現

#### 実装項目

##### Week 1: レセプトデータ生成
**電子請求フォーマット実装**
- [ ] 介護給付費請求書（様式第一）CSV生成
- [ ] 介護給付費明細書（様式第二）CSV生成
- [ ] 訪問看護療養費請求書（医療保険）CSV生成
- [ ] 訪問看護療養費明細書（医療保険）CSV生成

**月次レセプト確定機能**
- [ ] レセプト締め処理（月次確定）
- [ ] 確定後の修正制御
- [ ] 再計算・過誤調整機能

##### Week 2: レセプトチェック機能
**算定要件チェックエンジン**
- [ ] 回数制限違反検知（週3回上限等）
- [ ] 同時算定不可チェック
- [ ] 指示書期限切れアラート
- [ ] 保険証有効期限チェック
- [ ] 建物区分の整合性チェック

**加算漏れアラート**
- [ ] 該当するが未算定の加算を検知
  - 90分超訪問だが長時間加算なし
  - 緊急訪問理由あるが加算なし
  - 特別管理対象者だが加算なし
- [ ] 訪問記録作成時のリアルタイム警告

##### Week 3: レセプト管理画面
**レセプト確認・修正UI**
- [ ] 月次レセプト一覧
- [ ] 患者別明細表示
- [ ] エラー・警告の色分け表示
- [ ] 手動修正機能
- [ ] 請求済み/未請求ステータス管理
- [ ] 返戻・過誤調整画面

**Phase 5 成果物**:
- ✅ 国保連・支払基金対応の電子請求データ
- ✅ 算定ミス・加算漏れの自動検知
- ✅ レセプト業務の大幅効率化

---

### **Phase 6: 運用効率化・分析機能**
**期間**: 2週間
**優先度**: ★☆☆ 中
**目標**: 業務効率化と経営分析支援

#### 実装項目

##### Week 1: ダッシュボード
**レセプト分析画面**
- [ ] 月次請求額の推移グラフ
- [ ] 加算別取得率の可視化
- [ ] 患者別・看護師別実績分析
- [ ] 改定前後の比較分析グラフ

**アラート・通知機能**
- [ ] 指示書期限切れ予告（1ヶ月前）
- [ ] 保険証更新通知
- [ ] 未算定加算の一覧表示

##### Week 2: 帳票・レポート
**PDF出力機能**
- [ ] 訪問看護療養費請求書（PDF）
- [ ] 患者別請求明細書
- [ ] 事業所別集計表

**レセコン連携API**
- [ ] 外部レセコンへのデータエクスポートAPI
- [ ] CSV/XMLフォーマット対応
- [ ] バッチ処理機能

**Phase 6 成果物**:
- ✅ 経営分析ツール
- ✅ 帳票自動生成
- ✅ レセコン連携API

---

### 📊 Phase 4-6 スケジュールサマリ

| Phase | 内容 | 期間 | 累計 |
|-------|------|------|------|
| Phase 4 | 加算完全実装+改定対応基盤 | 5週間 | 5週間 |
| Phase 5 | レセプト電子請求対応 | 3週間 | 8週間 |
| Phase 6 | 運用効率化・分析 | 2週間 | 10週間 |

**総期間**: 10週間（約2.5ヶ月）

---

### 🔄 2026年4月改定時の運用フロー（想定）

#### 改定3ヶ月前（2026年1月）
厚生労働省が改定内容公表

#### 改定2ヶ月前（2026年2月）
1. 管理画面で各加算の「新バージョン作成」ボタンをクリック
2. 改定後の点数を入力（**所要時間：3分/加算 × 34項目 = 約2時間**）
3. テスト環境で動作確認

#### 改定1ヶ月前（2026年3月）
1. 本番環境に2026年度版を登録（valid_from: 2026/04/01）
2. スタッフ向け説明会実施
3. 2026年3月分のレセプトは2024年度版で処理（自動判定）

#### 改定日（2026年4月1日）
- **システムが自動的に2026年度版を適用開始**
- **コード変更ゼロ**
- 2026年4月分以降は新ルールで自動計算
- 特別な操作は不要

**メリット**:
- 改定作業時間：2週間 → **2時間**（95%削減）
- コード変更：**ゼロ**
- 過去データ整合性：**100%保証**

---

### 📈 期待される効果

#### 業務効率化
- レセプト作成時間: **80%削減**（手作業 → 自動計算）
- 加算漏れ: **90%削減**（自動チェック）
- 返戻率: **50%削減**（事前チェック）

#### 経営改善
- 加算取得率: **15%向上**（漏れ防止）
- 月次請求額: **平均10%増**（適切な加算算定）

#### 改定対応
- 改定作業時間: **95%削減**（2週間 → 2時間）
- コード変更: **ゼロ**
- 過去データ整合性: **100%保証**

---

### 📋 新規データベーステーブル（Phase 4-6）

| テーブル名 | 用途 | Phase |
|-----------|------|-------|
| `bonus_master` | 加算マスタ（バージョン管理） | Phase 4 |
| `bonus_calculation_history` | 加算計算履歴・監査証跡 | Phase 4 |
| `monthly_receipts` | 月次レセプトサマリ | Phase 4 |

---

**最終更新**: 2025-10-15
**ステータス**: ✅ **Phase 1-3 完了 - 実運用可能** | 🚧 **Phase 4-6 計画中**
